<div class="row">
    <div class="col-md-4">
        <h5>Add New Expense</h5>
        <form method="post" id="expense-form">
            {% csrf_token %}
            {% for field in expense_form %}
            <div class="mb-3" 
                {% if field.name == 'paid_via_account' %}id="paid-via-account-div"{% endif %}>
                
                <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                
                {{ field }} 
                
                {% for error in field.errors %}
                    <div class="text-danger small">{{ error }}</div>
                {% endfor %}
            </div>
            {% endfor %}
            <button type="submit" name="expense_submit" class="btn btn-success mt-2">Add Expense</button>
        </form>
    </div>
    
    <div class="col-md-8">
        <h5>Trip Costs ({{ trip_expenses|length }} items)</h5>
        <table class="table table-striped table-sm">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Category</th>
                    <th>Description</th>
                    <th>Amount (â‚¹)</th>
                    <th>Paid Via</th>
                </tr>
            </thead>
            <tbody>
                {% for expense in trip_expenses %}
                {% if expense.is_synthetic %}
                    <tr class="table-warning">
                        <td>{{ expense.date|date:"d-M" }}</td>
                        <td><strong>{{ expense.expense_category.name }}</strong></td>
                        <td>{{ expense.description }}</td>
                        <td>{{ expense.amount|floatformat:2 }}</td>
                        <td>{{ expense.paid_via_account.account_name }}</td>
                    </tr>
                {% else %}
                    <tr>
                        <td>{{ expense.date|date:"d-M" }}</td>
                        <td>{{ expense.expense_category.name }}</td>
                        <td>{{ expense.description|default:"-" }}</td>
                        <td>{{ expense.amount|floatformat:2 }}</td>
                        <td>{{ expense.paid_via_account.account_name|default:"N/A (Income)" }}</td>
                    </tr>
                {% endif %}
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center text-muted">No operational costs recorded for this trip yet.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>